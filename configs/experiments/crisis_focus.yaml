# configs/experiments/crisis_focus.yaml
# 위기 구간 집중 실험 설정

seed: 42
device: auto

# COVID-19 위기 중심 데이터
data:
  symbols: [
    "AAPL", "MSFT", "GOOGL", "AMZN", "NVDA", "META", "TSLA", "JPM",
    "V", "UNH", "WMT", "JNJ", "PG", "MA", "HD", "DIS", "PYPL", "BAC",
    "NFLX", "CMCSA", "PFE", "INTC", "CSCO", "VZ", "KO", "PEP", "MRK",
    "ABT", "NKE", "ADBE"
  ]
  start: "2019-01-01"      # 위기 전
  end: "2020-06-30"        # 위기 중/후
  test_start: "2020-07-01"  # 회복기
  test_end: "2021-12-31"    # 포스트 위기
  val_ratio: 0.2
  interval: "1d"
  cache: true

# 환경
env:
  initial_balance: 1000000
  transaction_cost: 0.001  # 위기 시 거래 비용
  slippage: 0.001          # 위기 시 슬리피지 증가
  max_leverage: 1.0
  window_size: 20

feature_dim: 12

# 오프라인 학습
offline:
  method: "iql"
  epochs: 30
  batch_size: 256
  expectile: 0.5  # 위기 시 덜 보수적 (더 많은 탐험)
  temperature: 0.5  # 낮은 온도 (더 결정적)

# IRT - 위기 적응 강화
irt:
  emb_dim: 128
  m_tokens: 8        # 더 많은 에피토프 (복잡한 패턴)
  M_proto: 10        # 더 많은 프로토타입 (다양한 전략)
  alpha: 0.4         # OT 비중 증가 (빠른 적응)
  eps: 0.03          # 낮은 엔트로피 (더 선명한 매칭)
  gamma: 0.7         # 높은 공자극 가중치 (위기 신호 중시)
  lambda_tol: 3.0    # 높은 내성 (과거 실패 회피)
  rho: 0.5           # 높은 체크포인트 (과신 억제)

# REDQ - 안정성 강화
redq:
  n_critics: 15      # 더 많은 앙상블 (안정성)
  m_sample: 3        # 더 보수적 타겟
  utd_ratio: 15      # 더 많은 업데이트 (빠른 학습)
  hidden_dims: [256, 256]
  actor_lr: 1e-4     # 낮은 학습률 (안정성)
  critic_lr: 1e-4
  gamma: 0.95        # 낮은 할인 (단기 중시)
  tau: 0.001         # 느린 타겟 업데이트 (안정성)
  buffer_size: 100000

# 학습
online_episodes: 300  # 더 많은 에피소드
skip_offline: false

# 목적함수 - 위기 중심
objectives:
  sharpe_beta: 0.5       # Sharpe 비중 감소
  sharpe_ema_alpha: 0.95  # 빠른 EMA
  cvar_alpha: 0.01       # 극단 위험 중시
  cvar_target: -0.01     # 엄격한 CVaR 목표
  lambda_cvar: 2.0       # 높은 CVaR 페널티
  lambda_turn: 0.2       # 높은 턴오버 페널티
  lambda_dd: 0.5         # Drawdown 페널티 추가
  r_clip: 3.0            # 낮은 클리핑 (안정성)

# 목표 (위기 구간)
targets:
  sharpe_ratio: 0.8      # 낮은 목표 (위기 시 현실적)
  max_drawdown: 0.20     # 엄격한 MDD
  cvar_99: -0.01         # 극단 위험 제한

# 로깅
log_level: "INFO"